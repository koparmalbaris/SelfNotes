# Installing Burp CA certificate on the android device at SYSTEM level.

If the requests do not drop to BurpSuite during mobile pentests and "The Client failed to negotiate an SSL Connection" error is received on the Burp Dashboard screen; the problem can be solved by installing the Burp CA certificate on the mobile device at SYSTEM level.

On Nougat (Android 7.0) and above systems, it is no longer possible to catch requests made by the mobile app with the traditional USER-level certificate installation process. 

HOWTO

	**List available Android Virtual Devices (AVD)**
	$ emulator -list-avds
	Pixel_2_API_29
	Pixel_3_API_28
	Pixel_XL_API_24
	Pixel_XL_API_25


	!> Only Android images upto **API 28** is supported! Newer Android AVDs does not offer a writable `/system`.


	**Run Android Virtual Device (AVD)**		
	$ emulator -avd <non_production_avd_name> -writable-system -no-snapshot



	$ openssl x509 -inform DER -in cacert.der -out cacert.pem
	$ openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1
	$ mv cacert.pem <hash>.0

	$ adb root
	$ adb remount
	$ adb push <cert>.0 /sdcard/

	$ mv /sdcard/<cert>.0 /system/etc/security/cacerts/
	$ chmod 644 /system/etc/security/cacerts/<cert>.0

^-^

Proxy configurations:
hostname: 10.0.2.2
port: 8080

Ref: https://0xf61.gitlab.io/blog/androidburpsetup/
Ref: https://blog.ropnop.com/configuring-burp-suite-with-android-nougat/
Ref: https://github.com/MobSF/docs/blob/master/dynamic_analyzer.md
